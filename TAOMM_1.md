# The Art of Mac Malware

[Link to free online book](https://taomm.org/)

[Link to Objective-See tools](https://objective-see.org/index.html)

# Chapter 1

# Chapter 2 Persistance

## Launch Agents and Daemons

### 3rd party launch daemons and agents
```bash
# daemons
/Library/LaunchDaemons/
# agents
~/Library/LaunchAgents/
```

### parsing .plist files
```bash
plutil -p <path to plist>
defaults read <path to plist>
```

### macOS debugger  
`lldb <path to file>`

## Scheduled Jobs  

### Cron Jobs  
`/usr/bin/crontab`  

### At Jobs

```bash
# stored at
/private/var/at/jobs/
# enumerate
/usr/bin/atq
# scheduler
/usr/libexec/atrun
/usr/bin/at
# enable scheduler
launchctl load -w /System/Library/LaunchDaemons/com.apple.atrun.plist
```

### Periodic Scripts

```bash
# stored at
/etc/periodic/
```

## Login and Logout Hooks

```bash
# stored at user-specific
~/Library/Preferences/com.apple.loginwindow.plist
```

## Dynamic Libraries

